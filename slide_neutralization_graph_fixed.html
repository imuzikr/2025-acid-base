<!DOCTYPE html>
<html lang="ko">
  <head>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
      
      body {
        font-family: 'Noto Sans KR', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f5f5f5;
      }
      
      .slide-container {
        width: 1280px;
        min-height: 720px;
        background: #FFFFFF;
        margin: 0 auto;
        position: relative;
        display: flex;
        flex-direction: column;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }
      
      .header {
        background-color: #2C3E50;
        color: white;
        padding: 20px 40px;
        font-size: 36px;
        font-weight: 700;
      }
      
      .content {
        display: flex;
        flex-direction: column;
        flex: 1;
        padding: 20px;
      }
      
      .section-title {
        font-size: 24px;
        font-weight: 600;
        color: #2C3E50;
        margin-bottom: 15px;
        padding-left: 10px;
        border-left: 4px solid #3498DB;
      }
      
      .explanation {
        font-size: 18px;
        color: #34495E;
        line-height: 1.5;
        margin-bottom: 20px;
      }
      
      .chart-container {
        width: 100%;
        height: 400px;
        margin-bottom: 20px;
      }
      
      .chart-instructions {
        text-align: center;
        margin-top: 10px;
        margin-bottom: 20px;
        color: #666;
        font-size: 16px;
      }
      
      .chart-instructions .highlight {
        color: #3498DB;
        font-weight: 600;
      }
      
      .chart-tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
      }
      
      .chart-tab {
        padding: 10px 20px;
        margin: 0 10px;
        background-color: #f8f9fa;
        border: 1px solid #e0e0e0;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .chart-tab.active {
        background-color: #3498DB;
        color: white;
        border-color: #3498DB;
      }
      
      .footer {
        padding: 15px 40px;
        background-color: #f8f9fa;
        color: #34495E;
        font-size: 18px;
        text-align: center;
        border-top: 1px solid #e9ecef;
      }
      
      .highlight {
        color: #3498DB;
        font-weight: 500;
      }
      
      /* 팝업 스타일 */
      .neutralization-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.9);
        background-color: white;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        width: 400px;
        max-width: 90%;
        opacity: 0;
        transition: all 0.3s ease;
      }
      
      .neutralization-popup.show {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      
      .popup-content {
        padding: 20px;
      }
      
      .popup-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        border-bottom: 1px solid #e0e0e0;
        padding-bottom: 10px;
      }
      
      .popup-header h3 {
        font-size: 18px;
        font-weight: 600;
        color: #2C3E50;
        margin: 0;
      }
      
      .popup-close {
        background: none;
        border: none;
        font-size: 24px;
        color: #7f8c8d;
        cursor: pointer;
      }
      
      .popup-body {
        font-size: 16px;
        color: #34495E;
      }
      
      .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 15px;
      }
      
      .info-item {
        padding: 5px 0;
      }
      
      .indicator-section {
        margin-top: 15px;
        border-top: 1px solid #e0e0e0;
        padding-top: 15px;
      }
      
      .indicator-section h4 {
        font-size: 16px;
        font-weight: 600;
        color: #2C3E50;
        margin-bottom: 10px;
      }
      
      .indicator-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      
      .indicator-item {
        display: flex;
        align-items: center;
      }
      
      .indicator-name {
        font-weight: 500;
        margin-right: 10px;
        width: 120px;
      }
    </style>
  </head>
  <body>
    <div class="slide-container">
      <div class="header">
        중화반응 그래프와 중화점
      </div>
      
      <div class="content">
        <div class="section-title">중화적정 곡선</div>
        <div class="explanation">
          <p>염산(HCl) 50mL와 수산화나트륨(NaOH) 50mL의 중화반응에서 <span class="highlight">pH 변화</span>와 <span class="highlight">온도 변화</span>를 보여주는 그래프입니다.</p>
          <p>그래프의 변곡점은 <span class="highlight">중화점(당량점)</span>을 나타내며, 이 지점에서 산과 염기가 완전히 반응합니다.</p>
        </div>
        
        <div class="chart-tabs">
          <div id="phTab" class="chart-tab active">pH 변화</div>
          <div id="tempTab" class="chart-tab">온도 변화</div>
        </div>
        
        <div id="phChartContainer" class="chart-container">
          <canvas id="phChart"></canvas>
        </div>
        
        <div id="tempChartContainer" class="chart-container" style="display: none;">
          <canvas id="tempChart"></canvas>
        </div>
        
        <div class="chart-instructions">
          <span class="highlight">주요 포인트를 클릭</span>하면 해당 지점의 상세 정보를 확인할 수 있습니다.
        </div>
      </div>
      
      <div class="footer">
        중화점에서는 <span class="highlight">pH가 급격히 변화</span>하고 <span class="highlight">온도가 최대</span>가 됩니다.
      </div>
    </div>
    
    <script>
      // 중화반응 데이터 (HCl + NaOH 중화적정)
      // 0.1M HCl 50mL에 0.1M NaOH 50mL를 적정하는 경우
      const neutralizationData = {
        // pH 변화 데이터 (NaOH 부피에 따른 pH 변화)
        phData: [
          { volume: 0, pH: 1.0, temperature: 25.0 },
          { volume: 5, pH: 1.18, temperature: 25.5 },
          { volume: 10, pH: 1.37, temperature: 26.0 },
          { volume: 15, pH: 1.60, temperature: 26.5 },
          { volume: 20, pH: 1.95, temperature: 27.0 },
          { volume: 25, pH: 2.20, temperature: 27.5 },
          { volume: 30, pH: 2.69, temperature: 28.0 },
          { volume: 35, pH: 3.00, temperature: 28.5 },
          { volume: 40, pH: 3.50, temperature: 29.0 },
          { volume: 45, pH: 4.50, temperature: 29.5 },
          { volume: 49, pH: 5.50, temperature: 29.8 },
          { volume: 49.5, pH: 6.00, temperature: 29.9 },
          { volume: 50.0, pH: 7.00, temperature: 30.0 }, // 중화점
          { volume: 50.5, pH: 8.00, temperature: 29.9 },
          { volume: 51, pH: 9.50, temperature: 29.8 },
          { volume: 55, pH: 11.00, temperature: 29.5 },
          { volume: 60, pH: 11.96, temperature: 29.0 },
          { volume: 65, pH: 12.22, temperature: 28.5 },
          { volume: 70, pH: 12.36, temperature: 28.0 },
          { volume: 75, pH: 12.50, temperature: 27.5 },
          { volume: 80, pH: 12.60, temperature: 27.0 },
          { volume: 85, pH: 12.70, temperature: 26.5 },
          { volume: 90, pH: 12.80, temperature: 26.0 },
          { volume: 95, pH: 12.90, temperature: 25.5 },
          { volume: 100, pH: 13.00, temperature: 25.0 }
        ],

        // 주요 포인트 정보
        keyPoints: [
          {
            volume: 0,
            pH: 1.0,
            temperature: 25.0,
            description: "적정 시작점",
            solution: "0.1M HCl 50mL",
            dominantIons: ["H⁺", "Cl⁻"],
            acidity: "강산성",
            color: "#ff4444"
          },
          {
            volume: 25,
            pH: 2.20,
            temperature: 27.5,
            description: "적정 중간점 (50% 중화)",
            solution: "HCl + NaOH (1:1)",
            dominantIons: ["H⁺", "Cl⁻", "Na⁺"],
            acidity: "산성",
            color: "#ff8844"
          },
          {
            volume: 49,
            pH: 5.50,
            temperature: 29.8,
            description: "중화점 직전",
            solution: "거의 중성에 가까운 상태",
            dominantIons: ["H⁺", "Cl⁻", "Na⁺"],
            acidity: "약산성",
            color: "#ffaa44"
          },
          {
            volume: 50.0,
            pH: 7.0,
            temperature: 30.0,
            description: "중화점 (당량점)",
            solution: "NaCl + H₂O",
            dominantIons: ["Na⁺", "Cl⁻"],
            acidity: "중성",
            color: "#44ff44"
          },
          {
            volume: 51,
            pH: 9.50,
            temperature: 29.8,
            description: "중화점 직후",
            solution: "과량의 NaOH",
            dominantIons: ["Na⁺", "Cl⁻", "OH⁻"],
            acidity: "약염기성",
            color: "#4488ff"
          },
          {
            volume: 75,
            pH: 12.50,
            temperature: 27.5,
            description: "과량 염기 상태",
            solution: "NaCl + 과량 NaOH",
            dominantIons: ["Na⁺", "Cl⁻", "OH⁻"],
            acidity: "강염기성",
            color: "#4444ff"
          }
        ],

        // 지시약 정보
        indicators: [
          {
            name: "메틸오렌지",
            transitionRange: [3.1, 4.4],
            acidColor: "빨간색",
            baseColor: "노란색",
            changePoint: 50.0
          },
          {
            name: "브로모티몰블루",
            transitionRange: [6.0, 7.6],
            acidColor: "노란색",
            baseColor: "파란색",
            changePoint: 50.0
          },
          {
            name: "페놀프탈레인",
            transitionRange: [8.2, 10.0],
            acidColor: "무색",
            baseColor: "분홍색",
            changePoint: 50.0
          }
        ]
      };

      // 온도 변화 데이터
      const temperatureData = {
        data: [
          { volume: 0, temperature: 25.0 },
          { volume: 5, temperature: 25.5 },
          { volume: 10, temperature: 26.0 },
          { volume: 15, temperature: 26.5 },
          { volume: 20, temperature: 27.0 },
          { volume: 25, temperature: 27.5 },
          { volume: 30, temperature: 28.0 },
          { volume: 35, temperature: 28.5 },
          { volume: 40, temperature: 29.0 },
          { volume: 45, temperature: 29.5 },
          { volume: 49, temperature: 29.8 },
          { volume: 49.5, temperature: 29.9 },
          { volume: 50.0, temperature: 30.0 }, // 최고 온도 (중화점)
          { volume: 50.5, temperature: 29.9 },
          { volume: 51, temperature: 29.8 },
          { volume: 55, temperature: 29.5 },
          { volume: 60, temperature: 29.0 },
          { volume: 65, temperature: 28.5 },
          { volume: 70, temperature: 28.0 },
          { volume: 75, temperature: 27.5 },
          { volume: 80, temperature: 27.0 },
          { volume: 85, temperature: 26.5 },
          { volume: 90, temperature: 26.0 },
          { volume: 95, temperature: 25.5 },
          { volume: 100, temperature: 25.0 }
        ]
      };
      
      // 인터랙티브 중화반응 차트 생성 함수
      function createInteractiveNeutralizationChart(canvasId, dataType = 'ph') {
        const ctx = document.getElementById(canvasId).getContext('2d');
        
        // 데이터 선택
        const chartData = dataType === 'ph' ? neutralizationData.phData : temperatureData.data;
        const yAxisLabel = dataType === 'ph' ? 'pH' : '온도 (°C)';
        const yAxisKey = dataType === 'ph' ? 'pH' : 'temperature';
        
        // 주요 포인트 데이터
        const keyPoints = neutralizationData.keyPoints;
        
        const chart = new Chart(ctx, {
          type: 'line',
          data: {
            datasets: [
              {
                label: yAxisLabel,
                data: chartData.map(point => ({
                  x: point.volume,
                  y: point[yAxisKey]
                })),
                borderColor: '#3498db',
                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                pointRadius: 0,
                pointHoverRadius: 8
              },
              {
                label: '주요 포인트',
                data: keyPoints.map(point => ({
                  x: point.volume,
                  y: dataType === 'ph' ? point.pH : point.temperature
                })),
                backgroundColor: keyPoints.map(point => point.color),
                borderColor: '#2c3e50',
                borderWidth: 2,
                pointRadius: 8,
                pointHoverRadius: 12,
                showLine: false,
                pointStyle: 'circle'
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: dataType === 'ph' ? 'HCl 50mL + NaOH 50mL 중화적정 곡선' : 'HCl 50mL + NaOH 50mL 중화반응 온도 변화',
                font: {
                  size: 18,
                  family: 'Noto Sans KR'
                }
              },
              legend: {
                display: true,
                position: 'top'
              },
              tooltip: {
                enabled: false // 커스텀 팝업을 사용하므로 기본 툴팁 비활성화
              }
            },
            scales: {
              x: {
                title: {
                  display: true,
                  text: 'NaOH 부피 (mL)',
                  font: {
                    size: 14,
                    family: 'Noto Sans KR'
                  }
                },
                min: 0,
                max: 100
              },
              y: {
                title: {
                  display: true,
                  text: yAxisLabel,
                  font: {
                    size: 14,
                    family: 'Noto Sans KR'
                  }
                },
                min: dataType === 'ph' ? 0 : 24,
                max: dataType === 'ph' ? 14 : 31
              }
            },
            interaction: {
              intersect: false,
              mode: 'point'
            },
            onClick: (event, elements) => {
              if (elements.length > 0) {
                const element = elements[0];
                if (element.datasetIndex === 1) { // 주요 포인트 클릭
                  const pointIndex = element.index;
                  const keyPoint = keyPoints[pointIndex];
                  showPopup(keyPoint, dataType);
                }
              }
            },
            onHover: (event, elements) => {
              event.native.target.style.cursor = elements.length > 0 && elements[0].datasetIndex === 1 ? 'pointer' : 'default';
            }
          }
        });
        
        return chart;
      }

      // 팝업 창 표시 함수
      function showPopup(keyPoint, dataType) {
        // 기존 팝업 제거
        const existingPopup = document.getElementById('neutralization-popup');
        if (existingPopup) {
          existingPopup.remove();
        }
        
        // 팝업 생성
        const popup = document.createElement('div');
        popup.id = 'neutralization-popup';
        popup.className = 'neutralization-popup';
        
        // 지시약 색상 정보 생성
        const indicatorInfo = neutralizationData.indicators.map(indicator => {
          const isInTransition = keyPoint.pH >= indicator.transitionRange[0] && keyPoint.pH <= indicator.transitionRange[1];
          const color = keyPoint.pH < indicator.transitionRange[0] ? indicator.acidColor : 
                        keyPoint.pH > indicator.transitionRange[1] ? indicator.baseColor : '변화 중';
          
          return `
            <div class="indicator-item">
              <span class="indicator-name">${indicator.name}:</span>
              <span class="indicator-color" style="color: ${getColorCode(color)}">${color}</span>
            </div>
          `;
        }).join('');
        
        popup.innerHTML = `
          <div class="popup-content">
            <div class="popup-header">
              <h3>${keyPoint.description}</h3>
              <button class="popup-close" onclick="closePopup()">&times;</button>
            </div>
            <div class="popup-body">
              <div class="info-grid">
                <div class="info-item">
                  <strong>NaOH 부피:</strong> ${keyPoint.volume} mL
                </div>
                <div class="info-item">
                  <strong>pH:</strong> ${keyPoint.pH}
                </div>
                <div class="info-item">
                  <strong>온도:</strong> ${keyPoint.temperature} °C
                </div>
                <div class="info-item">
                  <strong>액성:</strong> ${keyPoint.acidity}
                </div>
                <div class="info-item">
                  <strong>용액 상태:</strong> ${keyPoint.solution}
                </div>
                <div class="info-item">
                  <strong>주요 이온:</strong> ${keyPoint.dominantIons.join(', ')}
                </div>
              </div>
              <div class="indicator-section">
                <h4>지시약 색 변화</h4>
                <div class="indicator-list">
                  ${indicatorInfo}
                </div>
              </div>
            </div>
          </div>
        `;
        
        document.body.appendChild(popup);
        
        // 팝업 표시 애니메이션
        setTimeout(() => {
          popup.classList.add('show');
        }, 10);
      }

      // 팝업 닫기 함수
      function closePopup() {
        const popup = document.getElementById('neutralization-popup');
        if (popup) {
          popup.classList.remove('show');
          setTimeout(() => {
            popup.remove();
          }, 300);
        }
      }

      // 색상 코드 변환 함수
      function getColorCode(colorName) {
        const colorMap = {
          '빨간색': '#ff4444',
          '노란색': '#ffdd44',
          '파란색': '#4488ff',
          '분홍색': '#ff88cc',
          '무색': '#888888',
          '변화 중': '#aa88ff'
        };
        return colorMap[colorName] || '#333333';
      }

      // ESC 키로 팝업 닫기
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          closePopup();
        }
      });

      // 팝업 외부 클릭으로 닫기
      document.addEventListener('click', (event) => {
        const popup = document.getElementById('neutralization-popup');
        if (popup && !popup.querySelector('.popup-content').contains(event.target)) {
          closePopup();
        }
      });
      
      // 페이지 로드 시 차트 초기화
      window.onload = function() {
        // 초기 pH 차트 생성
        const phChart = createInteractiveNeutralizationChart('phChart', 'ph');
        
        // 탭 전환 기능
        document.getElementById('phTab').addEventListener('click', function() {
          document.getElementById('phTab').classList.add('active');
          document.getElementById('tempTab').classList.remove('active');
          document.getElementById('phChartContainer').style.display = 'block';
          document.getElementById('tempChartContainer').style.display = 'none';
        });
        
        document.getElementById('tempTab').addEventListener('click', function() {
          document.getElementById('tempTab').classList.add('active');
          document.getElementById('phTab').classList.remove('active');
          document.getElementById('phChartContainer').style.display = 'none';
          document.getElementById('tempChartContainer').style.display = 'block';
          
          // 온도 차트가 처음 표시될 때만 생성
          if (!window.tempChart) {
            window.tempChart = createInteractiveNeutralizationChart('tempChart', 'temperature');
          }
        });
      };
    </script>
  </body>
</html>

